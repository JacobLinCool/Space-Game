<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><style type="text/css">body,html{height:100%;margin:0;overflow:hidden;padding:0;width:100%}body{background-color:#6495ed}#box{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;width:100%}#canvas{background:#000}</style></head><body><div id="box"><canvas id="canvas" width="1600" height="1200"></canvas></div><script type="text/javascript">!function(t){var e={};function s(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(i,o,function(e){return t[e]}.bind(null,o));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=2)}([function(t,e,s){},,function(t,e,s){"use strict";function i(t){return document.querySelector(t)}function o(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}s.r(e);class n{constructor(t){this.attacker=t,this.damage=t.atk,this.x=t.x,this.y=t.y,this.speed=t.speed+6,this.head=t.head}offset(){return{x:Math.cos(this.head*Math.PI/180)*this.speed,y:Math.sin(this.head*Math.PI/180)*this.speed}}}class h{constructor({ship:t}){this.ship=t,this.maxHp=10,this.hp=10,this.def=1,this.center=[t.x,t.y],this.r=0,this.head=0,this.speed=3,this.x=this.center[0],this.y=this.center[1]}update(){this.r+=this.speed,this.head+=this.speed/Math.PI,this.x=this.center[0]+this.r*Math.cos(this.head),this.y=this.center[1]+this.r*Math.sin(this.head)}}class a{constructor({player:t=null,lv:e=0,speed:s=.5,x:i=0,y:o=0}){this.player=t,this.lv=e;let{hp:n,atk:h,def:a,storage:l,cost:d}=r(this.lv);this.maxHp=n,this.hp=n,this.atk=h,this.def=a,this.storage=l,this.resource=0,this.cost=d,this.x=i,this.y=o,this.head=90,this.speed=s,this.attackable=!0,this.attackDelay=250}upgrade(){if(this.player.token>=this.cost){this.player.token-=this.cost,this.lv++;let{hp:t,atk:e,def:s,storage:i,cost:o}=r(this.lv);return this.maxHp=t,this.atk=e,this.def=s,this.storage=i,this.cost=o,!0}return!1}speedUp(){this.speed<2&&(this.speed+=.05),this.speed=Math.min(this.speed,2)}speedDown(){this.speed>0&&(this.speed-=.05),this.speed=Math.max(this.speed,0)}turnLeft(){this.head+=3}turnRight(){this.head-=3}fire(){if(this.attackable)return this.attackable=!1,setTimeout(()=>{this.attackable=!0},this.attackDelay),new n(this)}offset(){return{x:Math.cos(this.head*Math.PI/180)*this.speed,y:Math.sin(this.head*Math.PI/180)*this.speed}}drone(){if(this.player.token>=50)return this.player.token-=50,new h(this)}}function r(t=0){return{hp:100+10*t,atk:25+5*t,def:50+20*parseInt(t/5),storage:25+10*parseInt(t/5),cost:100+20*(t+1)+100*parseInt((t+1)/5)}}var l={background:{color:"#000"},ship:{visible:1200,size:1}};const d=i("#canvas").getContext("2d"),{width:p,height:c}=i("#canvas");function f({player:t,enemies:e,bullets:s,stones:i,drones:n,background:h}){d.save(),d.fillStyle=l.background.color,d.fillRect(0,0,p,c),d.restore(),function(t){d.save(),d.fillStyle="#333";for(let e=0;e<t.length;e++){const s=o(t[0],t[e]);if(s>400&&Math.random()<(s-400)/200)continue;const i=u(t[e]);d.beginPath(),d.arc(i.x,i.y,l.ship.visible,0,2*Math.PI),d.fill()}d.restore()}(t.ships),function(t){d.save(),t.forEach(({x:t,y:e,color:s})=>{d.fillStyle=s;const i=u({x:t,y:e});d.beginPath(),d.arc(i.x,i.y,2,0,2*Math.PI),d.fill()}),d.restore()}(h.stars),function(t){d.save(),d.fillStyle="#87cefa",d.lineWidth=3;for(let e=0;e<t.length;e++){const s=t[e],i=o(t[0],s);if(i>400&&Math.random()<(i-400)/200)continue;const n=u({x:s.x+Math.cos(s.head*Math.PI/180)*s.speed*20*l.ship.size,y:s.y+Math.sin(s.head*Math.PI/180)*s.speed*20*l.ship.size}),h=u({x:s.x+7.5*Math.cos((s.head+120)*Math.PI/180)*l.ship.size,y:s.y+7.5*Math.sin((s.head+120)*Math.PI/180)*l.ship.size}),a=u({x:s.x+7.5*Math.cos((s.head-120)*Math.PI/180)*l.ship.size,y:s.y+7.5*Math.sin((s.head-120)*Math.PI/180)*l.ship.size});d.beginPath(),d.moveTo(n.x,n.y),d.lineTo(h.x,h.y),d.lineTo(a.x,a.y),d.closePath(),d.strokeStyle=d.fillStyle,t[e].def>0&&(d.strokeStyle="yellow"),d.stroke(),d.fill()}d.restore()}(t.ships),function(t,e){d.save(),d.fillStyle="red",d.lineWidth=3;for(let s=0;s<e.length;s++){let i=!1;for(let n=0;n<t.length;n++){const h=o(t[0],t[n]);if(!(h>400&&Math.random()<(h-400)/200)&&o(e[s],t[n])<l.ship.visible){i=!0;break}}if(i){const t=u({x:e[s].x+Math.cos(e[s].head*Math.PI/180)*e[s].speed*30*l.ship.size,y:e[s].y+Math.sin(e[s].head*Math.PI/180)*e[s].speed*30*l.ship.size}),i=u({x:e[s].x+7.5*Math.cos((e[s].head+120)*Math.PI/180)*l.ship.size,y:e[s].y+7.5*Math.sin((e[s].head+120)*Math.PI/180)*l.ship.size}),o=u({x:e[s].x+7.5*Math.cos((e[s].head-120)*Math.PI/180)*l.ship.size,y:e[s].y+7.5*Math.sin((e[s].head-120)*Math.PI/180)*l.ship.size});d.beginPath(),d.moveTo(t.x,t.y),d.lineTo(i.x,i.y),d.lineTo(o.x,o.y),d.closePath(),d.strokeStyle=d.fillStyle,e[s].def>0&&(d.strokeStyle="orange"),d.stroke(),d.fill()}}d.restore()}(t.ships,e),function(t,e){d.save(),d.lineWidth=2,d.strokeStyle="white";for(let s=0;s<e.length;s++){let i=!1;for(let n=0;n<t.length;n++){const h=o(t[0],t[n]);if(!(h>400&&Math.random()<(h-400)/200)&&o(e[s],t[n])<l.ship.visible){i=!0;break}}if(i){const t=u(e[s]),i=u({x:e[s].x+10*Math.cos((e[s].head+180)*Math.PI/180),y:e[s].y+10*Math.sin((e[s].head+180)*Math.PI/180)});d.beginPath(),d.moveTo(t.x,t.y),d.lineTo(i.x,i.y),d.stroke()}}d.restore()}(t.ships,s),function(t){d.save(),d.fillStyle="#fff",d.font="36px Arial",d.textBaseline="top",d.textAlign="left",d.fillText("Point: "+t.point,10,10),d.textAlign="right",d.fillText("Token: "+t.token,p-10,10),d.fillText(`Ship: ${t.ships.length} / 10`,p-10,60),d.restore()}(t)}function u({x:t=0,y:e=0}){return{x:t+p/2,y:c/2-e}}function y(...t){return v.play(...t)}const v={volume:.3,sampleRate:44100,x:new(window.AudioContext||webkitAudioContext),play:function(...t){return this.playSamples(this.buildSamples(...t))},playSamples:function(t){const e=this.x.createBuffer(1,t.length,this.sampleRate),s=this.x.createBufferSource();return e.getChannelData(0).set(t),s.buffer=e,s.connect(this.x.destination),s.start(),s},buildSamples:function(t=1,e=.05,s=220,i=0,o=0,n=.1,h=0,a=1,r=0,l=0,d=0,p=0,c=0,f=0,u=0,y=0,v=0,x=1,g=0,M=0){const m=2*Math.PI;let k,b,P=this.sampleRate,w=r*=500*m/P/P,S=s*=(1+2*e*Math.random()-e)*m/P,I=[],T=0,z=0,R=0,A=1,D=0,j=0,O=0;for(l*=500*m/P**3,u*=m/P,d*=m/P,p*=P,c=c*P|0,b=(i=i*P+9)+(g*=P)+(o*=P)+(n*=P)+(v*=P)|0;R<b;I[R++]=O)++j%(100*y|0)||(O=h?h>1?h>2?h>3?Math.sin((T%m)**3):Math.max(Math.min(Math.tan(T),1),-1):1-(2*T/m%2+2)%2:1-4*Math.abs(Math.round(T/m)-T/m):Math.sin(T),O=(c?1-M+M*Math.sin(m*R/c):1)*(O>0?1:-1)*Math.abs(O)**a*t*this.volume*(R<i?R/i:R<i+g?1-(R-i)/g*(1-x):R<i+g+o?x:R<b-v?(b-R-v)/n*x:0),O=v?O/2+(v>R?0:(R<b-v?1:(b-R)/v)*I[R-v|0]/2):O),k=(s+=r+=l)*Math.cos(u*z++),T+=k-k*f*(1-1e9*(Math.sin(R)+1)%2),A&&++A>p&&(s+=d,S+=d,A=0),!c||++D%c||(s=S,r=w,A=A||1);return I},getNote:function(t=0,e=440){return e*2**(t/12)}};var x={fire:function(){y(.5,void 0,2e3,void 0,.05,0,void 0,1.11,-17,void 0,197,.01,void 0,.2,void 0,void 0,void 0,void 0,.16)},saperate:function(){y(1,void 0,18,.01,.01,.21,1,.49,9.9,void 0,void 0,void 0,void 0,void 0,void 0,void 0,.04,.95,.02)},noise:function(t=.4){y(t,void 0,60,void 0,.01,0,4,.55,62,89,-88,.06,void 0,void 0,173,.6,void 0,void 0,.05)},disconnected:function(){y(2.03,void 0,413,void 0,void 0,.24,2,.12,void 0,void 0,void 0,void 0,.11,void 0,317,.1,.13,void 0,void 0,.01)},speed:function(t=200,e=.04){y(e,void 0,t,void 0,.02,.01,void 0,1.72,void 0,-86,118,.03,void 0,void 0,-5.2,void 0,void 0,void 0,.13)},rotate:function(){y(.03,void 0,10,.06,void 0,0,2,2.3,void 0,void 0,621,void 0,void 0,void 0,void 0,void 0,void 0,void 0,.21,.26)},explosion:function(){y(.6,void 0,372,.02,.02,.5,4,2.29,.2,void 0,void 0,void 0,void 0,.6,void 0,.6,void 0,.7,.04,.19)},defend:function(){y(2,void 0,180,.05,.03,.04,void 0,2.42,.6,void 0,void 0,void 0,void 0,void 0,void 0,void 0,.15,.39,.04)},gameover:function(){y(1.99,void 0,171,.02,.01,.08,4,2.39,14,void 0,void 0,void 0,void 0,.3,void 0,.1,.16,void 0,.1)}};const g=[];class M{constructor(t,e,s){this.x=t,this.y=e,this.color=s}}function m(t){const e=360*Math.random()*(Math.PI/180),s=1e3*(2*Math.random()+1),i={x:Math.cos(e)*s,y:Math.sin(e)*s};g.push(new M(i.x,i.y,`rgb(${64*Math.random()+159},${64*Math.random()+159},${64*Math.random()+159})`))}var k={stars:g,addStar:m,update:function(t){const e=t.offset();g.forEach((t,s)=>{o(t,{x:0,y:0})<2e3?(t.x-=3*e.x,t.y-=3*e.y):g.splice(s,1)}),g.length<50&&m()}};const b=new class{constructor({name:t="Player"}){this.name=t,this.ships=[new a({player:this})],this.token=200,this.point=0}}({name:"Player"}),P=[],w=[],S=[],I=[];let T=null;function z(t){if(!t.attackable)return;x.fire();const e=t.fire();w.push(e)}function R(){const t=360*Math.random()*(Math.PI/180),e=1e3*(1*Math.random()+1),s={x:Math.cos(t)*e,y:Math.sin(t)*e},i=new a({player:null,x:s.x,y:s.y,speed:1*Math.random()+.5});i.head=t+180,P.push(i)}var A=function(){return T=setInterval(()=>{!function(){const t=[],e=b.ships[0].offset();x.speed(400*b.ships[0].speed,.08);for(let s=1;s<b.ships.length;s++){const i=o(b.ships[0],b.ships[s]);if(i>1e3){t.push(s),console.log(`Ship ${s} has disconnected.`),x.disconnected();continue}i>400&&Math.random()>.5&&x.noise((1200-i)/800*.4),x.speed(400*b.ships[s].speed);const n=b.ships[s].offset();b.ships[s].x+=n.x-e.x,b.ships[s].y+=n.y-e.y}for(let e=t.length-1;e>=0;e--)b.ships.splice(t[e],1);const s=[];for(let t=0;t<w.length;t++){if(o(w[t],b.ships[0])>1200){s.push(t);continue}const i=w[t].offset();w[t].x+=i.x-e.x,w[t].y+=i.y-e.y}for(let t=s.length-1;t>=0;t--)w.splice(s[t],1);if(function(){const t=b.ships[0].offset(),e=[];for(let s=0;s<P.length;s++){if(o(P[s],b.ships[0])>2e3){e.push(s);continue}const i=P[s].offset();P[s].x+=i.x-t.x,P[s].y+=i.y-t.y}for(let t=e.length-1;t>=0;t--)P.splice(e[t],1);P.forEach(t=>{let e={x:b.ships[0].x,y:b.ships[0].y};if(b.ships.forEach(s=>{o(t,s)<o(t,e)&&(e=s)}),o(t,e)<=120){z(t);const s={x:t.x-e.x,y:t.y-e.y},i={x:Math.cos((t.head+90)*(Math.PI/180)),y:Math.sin((t.head+90)*(Math.PI/180))},o=s.x*i.x+s.y*i.y;o<0?t.turnLeft():o>0&&t.turnRight()}});for(;P.length<30;)R()}(),function(){const t=[];for(let e=0;e<w.length;e++){const s=w[e];s.attacker.player&&"Player"===s.attacker.player.name?P.forEach((i,n)=>{o(s,i)<9&&(t.push(e),i.def>0?(x.defend(),i.def-=s.damage):(x.explosion(),i.hp-=s.damage,i.hp<=0&&(P.splice(n,1),b.token+=20*(i.lv+1),b.point+=100*(i.lv+1)+500*parseInt(i.lv/5))),console.log("Hit",i))}):b.ships.forEach((i,n)=>{o(s,i)<9&&(t.push(e),i.def>0?(x.defend(),i.def-=s.damage):(x.explosion(),i.hp-=s.damage,i.hp<=0&&b.ships.splice(n,1)),console.log("Hit",i))})}for(let e=t.length-1;e>=0;e--)w.splice(t[e],1)}(),b.ships[0].hp<0)return x.gameover(),void clearInterval(T);k.update(b.ships[0])}(),f({player:b,enemies:P,bullets:w,stones:I,drones:S,background:k})},1e3/30),function(){const t={};window.onkeydown=window.onkeyup=function(e){if("keydown"===e.type?t[e.key]=!0:delete t[e.key],t.c&&function(){if(b.ships.length>=10)return;if(b.token<100)return;b.token-=100,x.saperate();const t=new a({player:b});t.speed=.8*b.ships[0].speed,t.head=b.ships[0].head,b.ships.push(t)}(),t.w||t.ArrowUp)if(t[0])for(let t=0;t<b.ships.length;t++)b.ships[t].speedUp();else{let e=!1;for(let s=1;s<b.ships.length;s++)t[s.toString()]&&(e=!0,b.ships[s].speedUp());e||b.ships[0].speedUp()}if(t.a||t.ArrowLeft)if(x.rotate(),t[0])for(let t=0;t<b.ships.length;t++)b.ships[t].turnLeft();else{let e=!1;for(let s=1;s<b.ships.length;s++)t[s.toString()]&&(e=!0,b.ships[s].turnLeft());e||b.ships[0].turnLeft()}if(t.s||t.ArrowDown)if(t[0])for(let t=0;t<b.ships.length;t++)b.ships[t].speedDown();else{let e=!1;for(let s=1;s<b.ships.length;s++)t[s.toString()]&&(e=!0,b.ships[s].speedDown());e||b.ships[0].speedDown()}if(t.d||t.ArrowRight)if(x.rotate(),t[0])for(let t=0;t<b.ships.length;t++)b.ships[t].turnRight();else{let e=!1;for(let s=1;s<b.ships.length;s++)t[s.toString()]&&(e=!0,b.ships[s].turnRight());e||b.ships[0].turnRight()}if(t[" "])if(t[0])for(let t=0;t<b.ships.length;t++)z(b.ships[t]);else{let e=!1;for(let s=1;s<b.ships.length;s++)t[s.toString()]&&(e=!0,z(b.ships[s]));e||z(b.ships[0])}if(t.v)if(t[0])for(let t=0;t<b.ships.length;t++)S.push(b.ships[t].drone());else{let e=!1;for(let s=1;s<b.ships.length;s++)t[s.toString()]&&(e=!0,S.push(b.ships[s].drone()));e||S.push(b.ships[0].drone())}}}(),{player:b,enemies:P,bullets:w,stones:I,drones:S,background:k,spawn:R}};!async function(t){const e=i("#canvas"),s=i("#box"),o=+getComputedStyle(s).width.replace("px",""),n=+getComputedStyle(s).height.replace("px","");o/n>t?(e.style.height=n+"px",e.style.width=n*t+"px"):(e.style.width=o+"px",e.style.height=o*(1/t)+"px")}(4/3),window.g=A();s(0)}]);</script></body></html>